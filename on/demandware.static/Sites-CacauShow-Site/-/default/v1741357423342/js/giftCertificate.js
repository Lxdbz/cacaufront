!function(){"use strict";var e,t={6766:function(e){function t(e){const t=$("#giftCertInvalidMessage");t.html(e),t.show()}function a(e){const t=e.closest(".form-group"),a=e.closest(".gift-cert-wrapper"),s=t.find(".invalid-feedback"),i=a.data("missing-error");s.html(i),e.addClass("is-invalid"),s.show()}function s(){const e=$(".gift-certificate-card"),t=$(".js-single-gift"),a=$(".js-multiple-gifts");e.length>2?(t.addClass("d-none"),a.removeClass("d-none")):(t.removeClass("d-none"),a.addClass("d-none"))}function i(){const e=$(".order-total-summary"),t=$(".giftcard__modal-summary");e.addClass("is__loading"),t.addClass("is__loading"),e.load(location.href+" .order-total-summary",(function(){e.removeClass("is__loading"),s()})),t.load(location.href+" .giftcard__modal-summary",(function(){t.removeClass("is__loading"),s()}))}function n(e){const t=$(".gift-cert-fields .form-group input"),s=$("#giftCertInvalidMessage");let i=!1;const n=$("#bkbank-card-number"),o=n.val();if($(".success-feedback, .invalid-feedback, div.balance").hide(),t.removeClass("is-invalid"),/^\d+$/.test(o)){if(e){const e=o.replace(/\d{4}(?=.)/g,"$& ");if($("#bkbank-fields-modal .cardNumber").text(e),!$("#bkbank-fields-modal").hasClass("show"))return $("#bkbank-fields-modal").modal("show"),!1;{const e=t.map((function(){return $(this).data("min-length")})).get();t.each((function(t){const s=$(this),n=s.val(),o=e[t],r=o&&n.length<o;n&&!r||(a(s),i=!0)}))}}}else o||(a(n),i=!0);return!i&&($("#giftCertInvalidMessage").html(""),s.hide(),!0)}function o(e){let t=e.toString();$("#basketHasAdyenPayments").val(!e),"true"==t&&($(".adyen-checkout__error-text, .adyen-checkout-input__inline-validation--invalid"),$(".adyen-checkout__label__text").removeClass("adyen-checkout__label__text--error"),$(".next-summary").removeClass("btn-disabled js-finish-creditcard").attr("data-next-gift",t))}$(document).on("click",".js-toggle-gift",(function(){$(this).find(".ic__fa").toggleClass("fa-toggle-on").toggleClass("fa-toggle-off"),$(".checkout__giftcard-container").slideToggle()})),$(document).ready((function(){s(),$(".success-feedback").hide(),$(".invalid-feedback").hide(),$("div.balance").hide(),$(".bkbankcvvmsk").mask("000"),$(".bkbankcardmsk").mask("AAAAAAAAAAAAAAAA"),$(".bkbankpassmsk").mask("AAAA"),$("#show_hide_password a").on("click",(function(e){e.preventDefault(),"text"==$("#show_hide_password input").attr("type")?($("#show_hide_password input").attr("type","password"),$("#show_hide_password i").addClass("fa-eye-slash"),$("#show_hide_password i").removeClass("fa-eye")):"password"==$("#show_hide_password input").attr("type")&&($("#show_hide_password input").attr("type","text"),$("#show_hide_password i").removeClass("fa-eye-slash"),$("#show_hide_password i").addClass("fa-eye"))}))})),e.exports={checkBalance:function(){$(".js-check-balance").on("click",(()=>{if($("div.balance").empty(),!n(!1))return!1;const e={cardNumber:$("#bkbank-card-number").val(),csrf_token:$("input[name=csrf_token]").val()};$(".checkout__step").addClass("is__loading"),$.ajax({url:window.Urls.checkBalance,data:e,success:e=>{$(".checkout__step").removeClass("is__loading"),$("#giftCertInvalidMessage").empty(),$("div.balance").html("<p><strong>Saldo</strong> de Vale Presente: <strong>"+e.balance+"</strong></p>"),$("div.balance").show()},error:e=>{t(e.responseJSON.errorMessage),$(".checkout__step").removeClass("is__loading")}})}))},submitGiftCertificate:function(){$(".js-submit-giftCert").on("click",(()=>{if($("div.balance").empty(),!n(!0))return!1;const e=$("#bkbank-card-number"),a=$("#bkbank-password"),s=$("#bkbank-cvv"),r={cardNumber:e.val(),password:a.val(),cvv:s.val(),csrf_token:$("input[name=csrf_token]").val()};$(".checkout__step").addClass("is__loading"),$(".success-feedback").hide(),$(".invalid-feedback").hide(),$("div.balance").hide(),$.ajax({url:window.Urls.addGiftCertificate,data:r,success:t=>{e.val(""),a.val(""),s.val(""),$(".applied-gift-certificates").html(t.giftCertificateCard),$(".order-total-summary").html(t.orderTotalSummary),$(".card-installments").html(t.installments),$(".js-back-selectPayment").fadeIn(),t.giftCertificates&&$(".giftcard__active .giftcard__list").html(t.giftCertificates);const n=$("#selectedPaymentOption");t.basketTotal<=0?("GIFT_CERTIFICATE"!==n.val()&&$("#selectedPaymentOption").data("previous-value",n.val()),$("#selectedPaymentOption").val("GIFT_CERTIFICATE"),$(".payment-options-block").addClass("payment-disabled")):n.data("previous-value")&&n.val(n.data("previous-value")),o(t.enableNextStep),i(),$(".checkout__step").removeClass("is__loading"),$("#giftCertValidMessage").html(t.successMessage),$(".success-feedback").show(),$("#giftCert").val("")},error:e=>{$(".success-feedback").hide(),$(".checkout__step").removeClass("is__loading"),t(e.responseJSON.errorMessage)}})}))},removeGiftCertificate:function(){$("body").on("click",".remove-gift-certificate",(e=>{e.preventDefault(),$(".checkout__step").addClass("is__loading");const t=e.target,a=t.href,s=$("input[name=csrf_token]").val();a&&$.ajax({url:a,data:{csrf_token:s},complete:e=>{e.responseJSON.giftCertificates?($(".giftcard__active .giftcard__list").html(e.responseJSON.giftCertificates),$(".applied-gift-certificates").empty()):$(".giftcard__active .giftcard__list, .applied-gift-certificates").empty(),$(t).closest(".gift-certificate").empty(),e.responseJSON.orderTotalSummary&&$(".order-total-summary").html(e.responseJSON.orderTotalSummary),e.responseJSON.installments&&$(".card-installments").html(e.responseJSON.installments),o(e.responseJSON.enableNextStep),i(),$(".payment-options-block").removeClass("payment-disabled"),$(".gift-certificate-card").length||$(".next-summary").addClass("btn-disabled"),$(".success-feedback, .invalid-feedback",".checkout__giftcard-container").hide(),$(".checkout__step").removeClass("is__loading")}})}))}}},8295:function(e){e.exports=function(e){"function"==typeof e?e():"object"==typeof e&&Object.keys(e).forEach((function(t){"function"==typeof e[t]&&e[t]()}))}}},a={};function s(e){var i=a[e];if(void 0!==i)return i.exports;var n=a[e]={exports:{}};return t[e](n,n.exports,s),n.exports}e=s(8295),$(document).ready((function(){e(s(6766))}))}();